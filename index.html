<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Entry to Google Sheets</title>
</head>
<body>
    <div id="data-rows">
        <!-- Row 1 -->
        <div class="row">
            <label>Port 1:</label>
            <input type="text" class="inputText" placeholder="Enter Text">
            <select class="dropdown1">
                <option value="Unload">Unload</option>
                <option value="Load">Load</option>
                <option value="Special">Special</option>
            </select>
            <select class="dropdown2">
                <option value="Option1">Option 1</option>
                <option value="Option2">Option 2</option>
                <option value="Option3">Option 3</option>
                <option value="Option4">Option 4</option>
                <option value="Option5">Option 5</option>
                <option value="Option6">Option 6</option>
                <option value="Option7">Option 7</option>
                <option value="Option8">Option 8</option>
            </select>
            <button onclick="sendData(1)">Submit Row</button>
        </div>
        <!-- Repeat rows as needed -->
    </div>

    <script>
        // Your Google Apps Script Web App URL (replace YOUR_DEPLOYED_SCRIPT_URL with the actual URL)
        const apiUrl = 'https://script.google.com/macros/s/AKfycbyyJ-7OOpHOHu3FWiOO1nKJcG5TVS_MSWoasRF8bAWXQHZAt_ftZAiviYmTecKBFun0/exec';

        function sendData(rowNumber) {
            // Select the row's input fields and dropdowns
            const row = document.querySelectorAll(".row")[rowNumber - 1];
            const inputText = row.querySelector(".inputText").value;
            const dropdown1 = row.querySelector(".dropdown1").value;
            const dropdown2 = row.querySelector(".dropdown2").value;

            // Create the data object to send to the Google Sheet
            const data = {
                rowNumber: rowNumber,
                inputText: inputText,
                dropdown1: dropdown1,
                dropdown2: dropdown2
            };

            // Send the data to the Google Apps Script API using fetch()
            fetch(apiUrl, {
              redirect: "follow",
              method: "POST",
              body: JSON.stringify(data),
              headers: {
                "Content-Type": "text/plain;charset=utf-8",
                  },
               })
            .then(response => response.text())
            .then(data => {
                console.log('Success:', data);
                alert('Row submitted successfully!');
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>
